import { newSpecPage } from '@stencil/core/testing';
import { HmcModal } from '../modal';
describe('hmc-modal', () => {
  let page;
  beforeEach(async () => {
    page = await newSpecPage({
      components: [HmcModal],
    });
  });
  it('builds', async () => {
    expect(new HmcModal()).toBeTruthy();
  });
  describe('renders', () => {
    it('should render default component', async () => {
      await page.setContent('<hmc-modal open></hmc-modal>');
      expect(page.root).toMatchInlineSnapshot(`
        <hmc-modal open="">
          <mock:shadow-root>
            <hmc-modal-overlay isopen="">
              <a href="javascript:void 0" id="start-trap" role="navigation"></a>
              <div aria-label="" aria-modal="true" class="modal-container no-footer-content no-header-content" role="dialog">
                <div class="p-x">
                  <div class="modal-header">
                    <hmc-button class="close-icon" icon-only="" kind="ghost" size="sm">
                      <hmc-icon name="close-m"></hmc-icon>
                    </hmc-button>
                  </div>
                </div>
                <div class="modal-content">
                  <slot></slot>
                </div>
              </div>
              <a href="javascript:void 0" id="end-trap" role="navigation"></a>
            </hmc-modal-overlay>
          </mock:shadow-root>
        </hmc-modal>
      `);
    });
  });
  describe('methods', () => {
    let eventSpy;
    beforeEach(async () => {
      await page.setContent('<hmc-modal></hmc-modal>');
      eventSpy = jest.fn();
      page.rootInstance.modalCloseRequest = {
        emit: eventSpy,
      };
    });
    it('should close the modal on clicked', async () => {
      page.rootInstance.handleModalClose();
      expect(eventSpy).toHaveBeenCalled();
    });
    it('should handle overlay clicked', async () => {
      page.rootInstance.overlayClickHandler();
      expect(eventSpy).toHaveBeenCalled();
    });
  });
});
