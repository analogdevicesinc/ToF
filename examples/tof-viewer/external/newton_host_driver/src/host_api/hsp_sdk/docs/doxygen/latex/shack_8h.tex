\hypertarget{shack_8h}{\section{shack.\-h File Reference}
\label{shack_8h}\index{shack.\-h@{shack.\-h}}
}


Header file for S\-H\-A\-C\-K functions.  


{\ttfamily \#include \char`\"{}utils/generic/generic.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}crypto/ccs/ccs.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}crypto/ksu/ksu.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}crypto/pka/pka.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{shack_8h_aef9f4b026f0d0193bccf8833576c3980}{Shack\-Set\-Key} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target, Const\-Ptr\-\_\-\-Msg256\-\_\-t key\-Data, uint32\-\_\-t attributes)
\begin{DoxyCompactList}\small\item\em Set a key value into a key slot along with supplied attributes. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_ab400a957671d82d610d1c7c8ab8ca382}{Shack\-Clear\-Key} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target)
\begin{DoxyCompactList}\small\item\em Clear the data in a key slot. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_ada18c01556036158f41f71366227fd6e}{Shack\-Gen\-Random\-Key} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target, uint32\-\_\-t attributes)
\begin{DoxyCompactList}\small\item\em Generate a random key and place it in a key slot along with supplied attributes. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a1f4f36e7dd353e4d9b4a59edc8531df0}{Shack\-Send\-Key} (void $\ast$target, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} source)
\begin{DoxyCompactList}\small\item\em Send a key through a private hardware channel to another silicon based crypto accelerator on the same die. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_ad73a3c9113131e22421db1074cdad8ee}{Shack\-Load\-Key} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} decryptor, Const\-Ptr\-\_\-\-Msg384\-\_\-t key\-Blob)
\begin{DoxyCompactList}\small\item\em Load a key into a key slot. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a30622da3a6be645e2e5dcbef35fe1730}{Decrypt\-Legacy\-Key} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} decryptor, Const\-Ptr\-\_\-\-Msg384\-\_\-t key\-Blob, uint32\-\_\-t attributes)
\begin{DoxyCompactList}\small\item\em Decrypts and loads a legacy key into a key slot. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a4ef864a8f5992d8626df2b5f6ac03fe7}{Shack\-Store\-Key} (Const\-Ptr\-\_\-\-Msg256\-\_\-t key\-Data, uint32\-\_\-t attributes, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} encryptor, Ptr\-\_\-\-Msg384\-\_\-t key\-Blob)
\begin{DoxyCompactList}\small\item\em Stores a key into a key blob. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_afdddf2b7c66040b9f1cd5583c25d3c88}{Shack\-Save\-Key} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} source, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} encryptor, Ptr\-\_\-\-Msg384\-\_\-t key\-Blob)
\begin{DoxyCompactList}\small\item\em Saves a key into a key blob. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a98ed21aacc244eedc3fe8617e90e9e46}{Shack\-Kdf\-Key} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} source, Const\-Ptr\-\_\-\-Msg256\-\_\-t data, uint32\-\_\-t attributes)
\begin{DoxyCompactList}\small\item\em Apply K\-D\-F function to source key, attributes, and 256-\/bit input to derive a new key. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a13a8c94f99eb6a7dbc2363e96db26f3a}{Shack\-Kdf\-Key\-Ex} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} source, const void $\ast$data, uint32\-\_\-t size, uint32\-\_\-t attributes)
\begin{DoxyCompactList}\small\item\em Apply K\-D\-F function to source key, attributes, and arbitrarily sized input to derive a new key. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a063c92006030df04edc285e05867df27}{Shack\-Kdf\-Pcr} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} source, \hyperlink{key__slots_8h_aeca73a12006d9b38eb209cc0f7cd31ef}{Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t} pcr\-Slot, uint32\-\_\-t attributes)
\begin{DoxyCompactList}\small\item\em Apply K\-D\-F function to source key, P\-C\-R value, and attributes to derive a new key. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_af854a29c11157d9452b7a44932ebd6da}{Shack\-Kdf\-As\-Pcr} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} source, \hyperlink{key__slots_8h_aeca73a12006d9b38eb209cc0f7cd31ef}{Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t} pcr\-Slot, uint32\-\_\-t attributes)
\begin{DoxyCompactList}\small\item\em Apply K\-D\-F function to source key, target P\-C\-R value, and attributes to derive a new key. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a2d1507d3170a6f2b4b531cc1ea486e66}{Shack\-Derive\-Ecc\-Public\-Key} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} source, Ptr\-\_\-\-Msg512\-\_\-t public\-Key)
\begin{DoxyCompactList}\small\item\em Generate the E\-C\-C public key using the specified E\-C\-C Private key. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a60b76229e542ee510ba667632a8cdd10}{Shack\-Ecc\-Pcr\-Sign} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} source, \hyperlink{key__slots_8h_aeca73a12006d9b38eb209cc0f7cd31ef}{Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t} pcr\-Reg, Const\-Ptr\-\_\-\-Msg256\-\_\-t data, Ptr\-\_\-\-Msg512\-\_\-t signature)
\begin{DoxyCompactList}\small\item\em Use the specified signing E\-C\-C private key to sign the hash of the concatenation of the specified P\-C\-R value and the 256-\/bit input. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_aada3591edf5f4d603e5d931376a4d2fc}{Shack\-Ecc\-Sign} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} source, Const\-Ptr\-\_\-\-Msg256\-\_\-t data, Ptr\-\_\-\-Msg512\-\_\-t signature)
\begin{DoxyCompactList}\small\item\em Use the specified signing E\-C\-C private key to sign the 256-\/bit input value. \end{DoxyCompactList}\item 
Hsp\-\_\-\-Status\-\_\-t \hyperlink{shack_8h_af29f2d3ba80e674692e443c96ca70226}{Shack\-Ecc\-Verify\-Signature} (Const\-Ptr\-\_\-\-Msg512\-\_\-t public\-Key, Const\-Ptr\-\_\-\-Msg256\-\_\-t digest, Const\-Ptr\-\_\-\-Msg512\-\_\-t signature)
\begin{DoxyCompactList}\small\item\em Use the provided E\-C\-C public key to verify a given message digest against a given signature. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a60536cc095e769d7fb7d8c1e8b8f4885}{Shack\-Ecdh\-Pcr\-Key\-Exchange} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} ecc\-Key, \hyperlink{key__slots_8h_aeca73a12006d9b38eb209cc0f7cd31ef}{Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t} pcr\-Reg, Const\-Ptr\-\_\-\-Msg512\-\_\-t public\-Key, uint32\-\_\-t attributes)
\begin{DoxyCompactList}\small\item\em Use the specified E\-C\-C private key to perform E\-C\-D\-H with the supplied public key. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_ab8b08cdbd3de0bac9f3f23e04e548e24}{Shack\-Ecdh\-Key\-Exchange} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} target, \hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} ecc\-Key, Const\-Ptr\-\_\-\-Msg512\-\_\-t public\-Key, uint32\-\_\-t attributes)
\begin{DoxyCompactList}\small\item\em Use the specified E\-C\-C private key to perform E\-C\-D\-H with the supplied public key. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a3044e07884d60ac7f3e57efdf6b97767}{Shack\-Extend\-Pcr} (\hyperlink{key__slots_8h_aeca73a12006d9b38eb209cc0f7cd31ef}{Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t} target, Const\-Ptr\-\_\-\-Msg256\-\_\-t data)
\begin{DoxyCompactList}\small\item\em Extend a value into a P\-C\-R register. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a9bc99b6dbc39cc41f34cf8faa0eaa165}{Shack\-Extend\-Pcr\-Ex} (\hyperlink{key__slots_8h_aeca73a12006d9b38eb209cc0f7cd31ef}{Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t} target, const void $\ast$data, uint32\-\_\-t size)
\begin{DoxyCompactList}\small\item\em Extend an arbitrarily sized value into a P\-C\-R register. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_aff97ebdffe5f11f7ff58185dd5a6fe72}{Shack\-Burn\-Key} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} key\-Slot)
\begin{DoxyCompactList}\small\item\em Burn the key and attributes in a key slot into the corresponding fuse location. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a17180c848104d74024a7afaff1cae44c}{Shack\-Aes\-Cbc256\-Decrypt} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} key, Const\-Ptr\-\_\-\-Msg128\-\_\-t initial\-Vec, void $\ast$data\-In, uint32\-\_\-t data\-Len, void $\ast$data\-Out, bool wait\-Completion)
\begin{DoxyCompactList}\small\item\em Decrypt payload using C\-B\-C mode. \end{DoxyCompactList}\item 
void \hyperlink{shack_8h_a3f639d622b01364f4d212f329281dd73}{Shack\-Aes\-Cbc256\-Encrypt} (\hyperlink{key__slots_8h_a32d0b2015305726d8e02f20b2b9a8ab9}{Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t} key, Const\-Ptr\-\_\-\-Msg128\-\_\-t initial\-Vec, void $\ast$data\-In, uint32\-\_\-t data\-Len, void $\ast$data\-Out, bool wait\-Completion)
\begin{DoxyCompactList}\small\item\em Encrypt payload using C\-B\-C mode. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Header file for S\-H\-A\-C\-K functions. 

\subsection{Function Documentation}
\hypertarget{shack_8h_a30622da3a6be645e2e5dcbef35fe1730}{\index{shack.\-h@{shack.\-h}!Decrypt\-Legacy\-Key@{Decrypt\-Legacy\-Key}}
\index{Decrypt\-Legacy\-Key@{Decrypt\-Legacy\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Decrypt\-Legacy\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Decrypt\-Legacy\-Key (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{decryptor, }
\item[{Const\-Ptr\-\_\-\-Msg384\-\_\-t}]{key\-Blob, }
\item[{uint32\-\_\-t}]{attributes}
\end{DoxyParamCaption}
)}}\label{shack_8h_a30622da3a6be645e2e5dcbef35fe1730}


Decrypts and loads a legacy key into a key slot. 

{\bfseries Description\-:} This operation mimics the K\-R\-\_\-\-D\-\_\-\-Decrypt operation on H\-S\-P 1.\-0 and is needed to support legacy applications. It takes an A\-E\-S encrypted 256-\/bit key blob, decrypts it using the specified key register and loads the resulting key and into a key register. The attributes on the destination key will default to zeros except the following five attributes that will be copied from the input attribute parameter\-: Send\-Key\-Allowed, A\-E\-S\-Encrypt\-Allowed, A\-E\-S\-Decrypt\-Allowed, A\-E\-S128bit\-Allowed, and A\-E\-S\-X\-T\-S\-Only.


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
{\em decryptor} & Decryption key slot\\
\hline
{\em key\-Blob} & Legacy key blob address\\
\hline
{\em attributes} & Attributes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a17180c848104d74024a7afaff1cae44c}{\index{shack.\-h@{shack.\-h}!Shack\-Aes\-Cbc256\-Decrypt@{Shack\-Aes\-Cbc256\-Decrypt}}
\index{Shack\-Aes\-Cbc256\-Decrypt@{Shack\-Aes\-Cbc256\-Decrypt}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Aes\-Cbc256\-Decrypt}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Aes\-Cbc256\-Decrypt (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{key, }
\item[{Const\-Ptr\-\_\-\-Msg128\-\_\-t}]{initial\-Vec, }
\item[{void $\ast$}]{data\-In, }
\item[{uint32\-\_\-t}]{data\-Len, }
\item[{void $\ast$}]{data\-Out, }
\item[{bool}]{wait\-Completion}
\end{DoxyParamCaption}
)}}\label{shack_8h_a17180c848104d74024a7afaff1cae44c}


Decrypt payload using C\-B\-C mode. 

{\bfseries Description\-:} Decrypt payload with provided with key and initial vector under A\-E\-S C\-B\-C mode.


\begin{DoxyParams}{Parameters}
{\em key} & 256 bit A\-E\-S C\-B\-C key slot id.\\
\hline
{\em initial\-Vec} & 128 bit initial input vector. In case of chaining multiple A\-E\-S operations, initial\-Vec needs to be provided in first call to the A\-P\-I, later calls it has to be null.\\
\hline
{\em data\-In} & pointer to where input data is stored, has to be in sharedram\\
\hline
{\em data\-Len} & size of data in bytes\\
\hline
{\em data\-Out} & pointer to where decrypted data will be stored, has to be in sharedram\\
\hline
{\em wait\-Completion} & wait on completion or defered check\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a3f639d622b01364f4d212f329281dd73}{\index{shack.\-h@{shack.\-h}!Shack\-Aes\-Cbc256\-Encrypt@{Shack\-Aes\-Cbc256\-Encrypt}}
\index{Shack\-Aes\-Cbc256\-Encrypt@{Shack\-Aes\-Cbc256\-Encrypt}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Aes\-Cbc256\-Encrypt}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Aes\-Cbc256\-Encrypt (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{key, }
\item[{Const\-Ptr\-\_\-\-Msg128\-\_\-t}]{initial\-Vec, }
\item[{void $\ast$}]{data\-In, }
\item[{uint32\-\_\-t}]{data\-Len, }
\item[{void $\ast$}]{data\-Out, }
\item[{bool}]{wait\-Completion}
\end{DoxyParamCaption}
)}}\label{shack_8h_a3f639d622b01364f4d212f329281dd73}


Encrypt payload using C\-B\-C mode. 

{\bfseries Description\-:} Encrypt payload with provided with key and initial vector under A\-E\-S C\-B\-C mode.


\begin{DoxyParams}{Parameters}
{\em key} & 256 bit A\-E\-S C\-B\-C key slot id.\\
\hline
{\em initial\-Vec} & 128 bit initial input vector. In case of chaining multiple A\-E\-S operations, initial\-Vec needs to be provided in first call to the A\-P\-I, later calls it has to be null.\\
\hline
{\em data\-In} & pointer to where input data is stored, has to be in sharedram\\
\hline
{\em data\-Len} & size of data in bytes\\
\hline
{\em data\-Out} & pointer to where encrypted data will be stored, has to be in sharedram\\
\hline
{\em wait\-Completion} & wait on completion or defered check\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_aff97ebdffe5f11f7ff58185dd5a6fe72}{\index{shack.\-h@{shack.\-h}!Shack\-Burn\-Key@{Shack\-Burn\-Key}}
\index{Shack\-Burn\-Key@{Shack\-Burn\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Burn\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Burn\-Key (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{key\-Slot}
\end{DoxyParamCaption}
)}}\label{shack_8h_aff97ebdffe5f11f7ff58185dd5a6fe72}


Burn the key and attributes in a key slot into the corresponding fuse location. 

{\bfseries Description\-:} Copy the key and attributes in the specified key slot to the fuse location corresponding to this key slot. This command first makes sure all fuses associated with the specified key slot are unprogrammed and then programs the key value and attributes in fuses using fuse controller commands. Only the first N (currently N=4) key slots have corresponding fuses. The fuse controller sends these values to K\-S\-U through the K\-S\-U import interface at initialization. If an improper key slot is specified, the command will fail with no changes to keys, or fuses.


\begin{DoxyParams}{Parameters}
{\em key\-Slot} & Key slot\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_ab400a957671d82d610d1c7c8ab8ca382}{\index{shack.\-h@{shack.\-h}!Shack\-Clear\-Key@{Shack\-Clear\-Key}}
\index{Shack\-Clear\-Key@{Shack\-Clear\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Clear\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Clear\-Key (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target}
\end{DoxyParamCaption}
)}}\label{shack_8h_ab400a957671d82d610d1c7c8ab8ca382}


Clear the data in a key slot. 

{\bfseries Description\-:} Clears the data in a key slot by setting it to all zero, including attributes.


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a2d1507d3170a6f2b4b531cc1ea486e66}{\index{shack.\-h@{shack.\-h}!Shack\-Derive\-Ecc\-Public\-Key@{Shack\-Derive\-Ecc\-Public\-Key}}
\index{Shack\-Derive\-Ecc\-Public\-Key@{Shack\-Derive\-Ecc\-Public\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Derive\-Ecc\-Public\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Derive\-Ecc\-Public\-Key (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{source, }
\item[{Ptr\-\_\-\-Msg512\-\_\-t}]{public\-Key}
\end{DoxyParamCaption}
)}}\label{shack_8h_a2d1507d3170a6f2b4b531cc1ea486e66}


Generate the E\-C\-C public key using the specified E\-C\-C Private key. 

{\bfseries Description\-:} Apply the appropriate E\-C\-C operation on the E\-C\-C Private key in the specified key slot to generate the corresponding E\-C\-C public key and return the E\-C\-C public key.


\begin{DoxyParams}{Parameters}
{\em source} & Source key slot\\
\hline
{\em public\-Key} & Address to receive 512-\/bit output\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a60b76229e542ee510ba667632a8cdd10}{\index{shack.\-h@{shack.\-h}!Shack\-Ecc\-Pcr\-Sign@{Shack\-Ecc\-Pcr\-Sign}}
\index{Shack\-Ecc\-Pcr\-Sign@{Shack\-Ecc\-Pcr\-Sign}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Ecc\-Pcr\-Sign}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Ecc\-Pcr\-Sign (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{source, }
\item[{{\bf Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t}}]{pcr\-Reg, }
\item[{Const\-Ptr\-\_\-\-Msg256\-\_\-t}]{data, }
\item[{Ptr\-\_\-\-Msg512\-\_\-t}]{signature}
\end{DoxyParamCaption}
)}}\label{shack_8h_a60b76229e542ee510ba667632a8cdd10}


Use the specified signing E\-C\-C private key to sign the hash of the concatenation of the specified P\-C\-R value and the 256-\/bit input. 

{\bfseries Description\-:} Use the specified signing E\-C\-C private key to sign the S\-H\-A256\-\_\-\-A\-U\-T\-O\-P\-A\-D hash of the concatenation of the specified P\-C\-R value, and the 256-\/bit input. The operations are\-: Temp = S\-H\-A256\-\_\-\-A\-U\-T\-O\-P\-A\-D(input value $|$$|$ P\-C\-R value) E\-C\-D\-S\-A signature = E\-C\-C256\-\_\-sign(\-Temp, E\-C\-C Signing key)


\begin{DoxyParams}{Parameters}
{\em source} & Source key slot\\
\hline
{\em pcr\-Reg} & P\-C\-R slot\\
\hline
{\em data} & Address of 256-\/bit input\\
\hline
{\em signature} & Output signature\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_aada3591edf5f4d603e5d931376a4d2fc}{\index{shack.\-h@{shack.\-h}!Shack\-Ecc\-Sign@{Shack\-Ecc\-Sign}}
\index{Shack\-Ecc\-Sign@{Shack\-Ecc\-Sign}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Ecc\-Sign}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Ecc\-Sign (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{source, }
\item[{Const\-Ptr\-\_\-\-Msg256\-\_\-t}]{data, }
\item[{Ptr\-\_\-\-Msg512\-\_\-t}]{signature}
\end{DoxyParamCaption}
)}}\label{shack_8h_aada3591edf5f4d603e5d931376a4d2fc}


Use the specified signing E\-C\-C private key to sign the 256-\/bit input value. 

{\bfseries Description\-:} Use the specified signing E\-C\-C private key to sign the 256-\/bit input value.


\begin{DoxyParams}{Parameters}
{\em source} & Source key slot\\
\hline
{\em data} & Address of 256-\/bit input\\
\hline
{\em signature} & Output signature\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_af29f2d3ba80e674692e443c96ca70226}{\index{shack.\-h@{shack.\-h}!Shack\-Ecc\-Verify\-Signature@{Shack\-Ecc\-Verify\-Signature}}
\index{Shack\-Ecc\-Verify\-Signature@{Shack\-Ecc\-Verify\-Signature}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Ecc\-Verify\-Signature}]{\setlength{\rightskip}{0pt plus 5cm}Hsp\-\_\-\-Status\-\_\-t Shack\-Ecc\-Verify\-Signature (
\begin{DoxyParamCaption}
\item[{Const\-Ptr\-\_\-\-Msg512\-\_\-t}]{public\-Key, }
\item[{Const\-Ptr\-\_\-\-Msg256\-\_\-t}]{digest, }
\item[{Const\-Ptr\-\_\-\-Msg512\-\_\-t}]{signature}
\end{DoxyParamCaption}
)}}\label{shack_8h_af29f2d3ba80e674692e443c96ca70226}


Use the provided E\-C\-C public key to verify a given message digest against a given signature. 

{\bfseries Description\-:} Use the provided 512-\/bit E\-C\-C public key to verify a given message digest (256-\/bit hash) against a given 512-\/bit signature. {\ttfamily H\-S\-P\-\_\-\-S\-U\-C\-C\-E\-S\-S} is returned if verification succeeds, or {\ttfamily H\-S\-P\-\_\-\-S\-I\-G\-N\-A\-T\-U\-R\-E\-\_\-\-M\-I\-S\-M\-A\-T\-C\-H} if it fails.


\begin{DoxyParams}{Parameters}
{\em public\-Key} & Address of 512-\/bit E\-C\-C public key. Will be copied into shared memory (i.\-e. H\-S\-P accessible) if necessary.\\
\hline
{\em digest} & Address of 256-\/bit S\-H\-A digest. Must be H\-S\-P accessible (i.\-e. in shared memory).\\
\hline
{\em signature} & Address of 512-\/bit signature. Must be H\-S\-P accessible (i.\-e. in shared memory).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily H\-S\-P\-\_\-\-S\-U\-C\-C\-E\-S\-S} if successful, or {\ttfamily H\-S\-P\-\_\-\-S\-I\-G\-N\-A\-T\-U\-R\-E\-\_\-\-M\-I\-S\-M\-A\-T\-C\-H} if not. 
\end{DoxyReturn}
\hypertarget{shack_8h_ab8b08cdbd3de0bac9f3f23e04e548e24}{\index{shack.\-h@{shack.\-h}!Shack\-Ecdh\-Key\-Exchange@{Shack\-Ecdh\-Key\-Exchange}}
\index{Shack\-Ecdh\-Key\-Exchange@{Shack\-Ecdh\-Key\-Exchange}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Ecdh\-Key\-Exchange}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Ecdh\-Key\-Exchange (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{ecc\-Key, }
\item[{Const\-Ptr\-\_\-\-Msg512\-\_\-t}]{public\-Key, }
\item[{uint32\-\_\-t}]{attributes}
\end{DoxyParamCaption}
)}}\label{shack_8h_ab8b08cdbd3de0bac9f3f23e04e548e24}


Use the specified E\-C\-C private key to perform E\-C\-D\-H with the supplied public key. 

{\bfseries Description\-:} Use the specified E\-C\-C private key to perform E\-C\-D\-H with the provided public key. The resulting E\-C point’s X coordinate is hashed with the Destination Attributes to form the 256-\/bit key placed in the destination key slot. The Destination Attributes are placed in the destination key slot. The operations are\-: Shared secret = E\-C\-C\-\_\-\-P\-T\-\_\-\-M\-U\-L\-T\-I\-P\-L\-I\-C\-A\-T\-I\-O\-N\-\_\-256(\-E\-C\-C private key, partner public key) Destination key = S\-H\-A256\-\_\-\-A\-U\-T\-O\-P\-A\-D(Shared secret X coordinate $|$$|$ Destination attributes)


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
{\em ecc\-Key} & Private E\-C\-C key slot\\
\hline
{\em public\-Key} & Address of partner public key\\
\hline
{\em attributes} & Destination attributes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a60536cc095e769d7fb7d8c1e8b8f4885}{\index{shack.\-h@{shack.\-h}!Shack\-Ecdh\-Pcr\-Key\-Exchange@{Shack\-Ecdh\-Pcr\-Key\-Exchange}}
\index{Shack\-Ecdh\-Pcr\-Key\-Exchange@{Shack\-Ecdh\-Pcr\-Key\-Exchange}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Ecdh\-Pcr\-Key\-Exchange}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Ecdh\-Pcr\-Key\-Exchange (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{ecc\-Key, }
\item[{{\bf Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t}}]{pcr\-Reg, }
\item[{Const\-Ptr\-\_\-\-Msg512\-\_\-t}]{public\-Key, }
\item[{uint32\-\_\-t}]{attributes}
\end{DoxyParamCaption}
)}}\label{shack_8h_a60536cc095e769d7fb7d8c1e8b8f4885}


Use the specified E\-C\-C private key to perform E\-C\-D\-H with the supplied public key. 

{\bfseries Description\-:} Use the specified E\-C\-C private key to perform E\-C\-D\-H with the supplied public key. The resulting E\-C point’s X coordinate is hashed with the Destination Attributes and the P\-C\-R value in the supplied P\-C\-R slot number to form the 256-\/bit key which is placed into the destination key slot. The Destination Attributes are placed in the destination key slot. The operations are\-: Shared secret = E\-C\-C\-\_\-\-P\-T\-\_\-\-M\-U\-L\-T\-I\-P\-L\-I\-C\-A\-T\-I\-O\-N\-\_\-256(\-Private E\-C\-C key, partner public key) Destination key = S\-H\-A256\-\_\-\-A\-U\-T\-O\-P\-A\-D(Shared secret X coordinate $|$$|$ P\-C\-R value $|$$|$ Destination attributes)


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
{\em ecc\-Key} & Private E\-C\-C key slot\\
\hline
{\em pcr\-Reg} & P\-C\-R slot\\
\hline
{\em public\-Key} & Address of partner public key\\
\hline
{\em attributes} & Destination attributes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a3044e07884d60ac7f3e57efdf6b97767}{\index{shack.\-h@{shack.\-h}!Shack\-Extend\-Pcr@{Shack\-Extend\-Pcr}}
\index{Shack\-Extend\-Pcr@{Shack\-Extend\-Pcr}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Extend\-Pcr}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Extend\-Pcr (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{Const\-Ptr\-\_\-\-Msg256\-\_\-t}]{data}
\end{DoxyParamCaption}
)}}\label{shack_8h_a3044e07884d60ac7f3e57efdf6b97767}


Extend a value into a P\-C\-R register. 

{\bfseries Description\-:} Extend a value into a P\-C\-R register. The new P\-C\-R value is the S\-H\-A-\/256 of the concatenation of the P\-C\-R value with the input 256-\/bit value added to the end of the S\-H\-A message. New P\-C\-R value = S\-H\-A256\-\_\-\-A\-U\-T\-O\-P\-A\-D(P\-C\-R\-\_\-value $|$$|$ 256-\/bit input value).


\begin{DoxyParams}{Parameters}
{\em target} & P\-C\-R slot\\
\hline
{\em data} & Address of 256-\/bit input\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a9bc99b6dbc39cc41f34cf8faa0eaa165}{\index{shack.\-h@{shack.\-h}!Shack\-Extend\-Pcr\-Ex@{Shack\-Extend\-Pcr\-Ex}}
\index{Shack\-Extend\-Pcr\-Ex@{Shack\-Extend\-Pcr\-Ex}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Extend\-Pcr\-Ex}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Extend\-Pcr\-Ex (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{const void $\ast$}]{data, }
\item[{uint32\-\_\-t}]{size}
\end{DoxyParamCaption}
)}}\label{shack_8h_a9bc99b6dbc39cc41f34cf8faa0eaa165}


Extend an arbitrarily sized value into a P\-C\-R register. 

{\bfseries Description\-:} Extend a value into a P\-C\-R register. Similar to {\ttfamily Shack\-Extend\-Pcr} but takes any sized buffer (up to 256 bits).


\begin{DoxyParams}{Parameters}
{\em target} & P\-C\-R slot\\
\hline
{\em data} & Address of input data\\
\hline
{\em size} & Size of input data\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_ada18c01556036158f41f71366227fd6e}{\index{shack.\-h@{shack.\-h}!Shack\-Gen\-Random\-Key@{Shack\-Gen\-Random\-Key}}
\index{Shack\-Gen\-Random\-Key@{Shack\-Gen\-Random\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Gen\-Random\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Gen\-Random\-Key (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{uint32\-\_\-t}]{attributes}
\end{DoxyParamCaption}
)}}\label{shack_8h_ada18c01556036158f41f71366227fd6e}


Generate a random key and place it in a key slot along with supplied attributes. 

{\bfseries Description\-:} Generate a random key and place it in a key slot along with supplied attributes.


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
{\em attributes} & Attributes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_af854a29c11157d9452b7a44932ebd6da}{\index{shack.\-h@{shack.\-h}!Shack\-Kdf\-As\-Pcr@{Shack\-Kdf\-As\-Pcr}}
\index{Shack\-Kdf\-As\-Pcr@{Shack\-Kdf\-As\-Pcr}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Kdf\-As\-Pcr}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Kdf\-As\-Pcr (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{source, }
\item[{{\bf Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t}}]{pcr\-Slot, }
\item[{uint32\-\_\-t}]{attributes}
\end{DoxyParamCaption}
)}}\label{shack_8h_af854a29c11157d9452b7a44932ebd6da}


Apply K\-D\-F function to source key, target P\-C\-R value, and attributes to derive a new key. 

{\bfseries Description\-:} A S\-H\-A-\/256 based K\-D\-F function (must match one used by K\-D\-F\-P\-C\-R) is applied to the source key, the supplied target P\-C\-R value, and the supplied attributes to derive a new key. The target P\-C\-R is expected value of a P\-C\-R register that would allow deriving this key in the future using a K\-D\-F\-P\-C\-R command. The new key along with the attributes is stored in the destination key slot. However, the attributes in the destination key slot are modified by clearing the Load\-Key\-Allowed attribute and setting the Store\-Key\-Allowed attribute. This enables the destination key slot to be used for storing keys that can be loaded in the future when the exact same key is generated into a key slot using K\-D\-F\-P\-C\-R. After the command completes, key in the destination address = S\-H\-A256\-\_\-\-A\-U\-T\-O\-P\-A\-D(source key $|$$|$ Target P\-C\-R $|$$|$ new attributes). This complex command is different from all others in that the attributes used in the K\-D\-F function are not the same as the ones written out at the destination key slot.


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
{\em source} & Source key slot\\
\hline
{\em pcr\-Slot} & Target P\-C\-R value\\
\hline
{\em attributes} & Attributes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a98ed21aacc244eedc3fe8617e90e9e46}{\index{shack.\-h@{shack.\-h}!Shack\-Kdf\-Key@{Shack\-Kdf\-Key}}
\index{Shack\-Kdf\-Key@{Shack\-Kdf\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Kdf\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Kdf\-Key (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{source, }
\item[{Const\-Ptr\-\_\-\-Msg256\-\_\-t}]{data, }
\item[{uint32\-\_\-t}]{attributes}
\end{DoxyParamCaption}
)}}\label{shack_8h_a98ed21aacc244eedc3fe8617e90e9e46}


Apply K\-D\-F function to source key, attributes, and 256-\/bit input to derive a new key. 

{\bfseries Description\-:} A S\-H\-A-\/256 based K\-D\-F function is applied to the key in the source key slot, the supplied attributes, and the 256-\/bit input to derive a new key. The new key along with the new attributes are stored in the destination key slot. If the E\-C\-C\-Sign\-Allowed or E\-C\-D\-H\-Allowed attribute bit is set in the input attribute field, the resulting key from the K\-D\-F\-Key operation must conform to the requirements of a private E\-C\-C-\/\-P256 key (automatically satisfied by M\-S P\-K\-A engine). After the command completes, key in destination address = S\-H\-A256\-\_\-\-A\-U\-T\-O\-P\-A\-D(input bits $|$$|$ source key $|$$|$ new attributes). “new attributes” means 24-\/bits of attributes for the newly derived key after enforcement of all attribute requirements.


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
{\em source} & Source key slot\\
\hline
{\em data} & Address of 256-\/bit input\\
\hline
{\em attributes} & Attributes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a13a8c94f99eb6a7dbc2363e96db26f3a}{\index{shack.\-h@{shack.\-h}!Shack\-Kdf\-Key\-Ex@{Shack\-Kdf\-Key\-Ex}}
\index{Shack\-Kdf\-Key\-Ex@{Shack\-Kdf\-Key\-Ex}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Kdf\-Key\-Ex}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Kdf\-Key\-Ex (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{source, }
\item[{const void $\ast$}]{data, }
\item[{uint32\-\_\-t}]{size, }
\item[{uint32\-\_\-t}]{attributes}
\end{DoxyParamCaption}
)}}\label{shack_8h_a13a8c94f99eb6a7dbc2363e96db26f3a}


Apply K\-D\-F function to source key, attributes, and arbitrarily sized input to derive a new key. 

{\bfseries Description\-:} K\-D\-F a key with a value. Similar to {\ttfamily Shack\-Extend\-Pcr} but takes any sized buffer (up to 256 bits).


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
{\em source} & Source key slot\\
\hline
{\em data} & Address of input data\\
\hline
{\em size} & Size of input data\\
\hline
{\em attributes} & Attributes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a063c92006030df04edc285e05867df27}{\index{shack.\-h@{shack.\-h}!Shack\-Kdf\-Pcr@{Shack\-Kdf\-Pcr}}
\index{Shack\-Kdf\-Pcr@{Shack\-Kdf\-Pcr}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Kdf\-Pcr}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Kdf\-Pcr (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{source, }
\item[{{\bf Ksu\-\_\-\-Pcr\-\_\-\-Slot\-\_\-t}}]{pcr\-Slot, }
\item[{uint32\-\_\-t}]{attributes}
\end{DoxyParamCaption}
)}}\label{shack_8h_a063c92006030df04edc285e05867df27}


Apply K\-D\-F function to source key, P\-C\-R value, and attributes to derive a new key. 

{\bfseries Description\-:} A S\-H\-A-\/256 based K\-D\-F function is applied to the source key, and the P\-C\-R value, and the supplied attributes to derive a new key. The order of arguments for the S\-H\-A-\/256 is intentionally different from the K\-D\-F\-Key command. The new key along with the new attributes is stored in the destination key slot. Note\-: If the E\-C\-D\-S\-A\-Allowed or E\-C\-D\-H\-Allowed attribute bit is set in the input attribute field, the resulting key from the K\-D\-F\-P\-C\-R operation must conform to the requirements of a private E\-C\-C-\/\-P256 key (automatically satisfied by M\-S P\-K\-A engine). After the command completes, the key in destination address = S\-H\-A256\-\_\-\-A\-U\-T\-O\-P\-A\-D(source key $|$$|$ P\-C\-R $|$$|$ new attributes). The “new attributes” argument means 24-\/bits of attributes for the newly-\/derived key after enforcement of all attribute requirements.


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
{\em source} & Source key slot\\
\hline
{\em pcr\-Slot} & P\-C\-R slot\\
\hline
{\em attributes} & Attributes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_ad73a3c9113131e22421db1074cdad8ee}{\index{shack.\-h@{shack.\-h}!Shack\-Load\-Key@{Shack\-Load\-Key}}
\index{Shack\-Load\-Key@{Shack\-Load\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Load\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Load\-Key (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{decryptor, }
\item[{Const\-Ptr\-\_\-\-Msg384\-\_\-t}]{key\-Blob}
\end{DoxyParamCaption}
)}}\label{shack_8h_ad73a3c9113131e22421db1074cdad8ee}


Load a key into a key slot. 

{\bfseries Description\-:} Takes a key blob which contains a 256-\/bit key, associated attributes, and 64-\/bit Initial Value (I\-V) value; decrypts and verifies the I\-V value. If the integrity check passes, the decrypted key and its attributes are loaded into the destination key slot.


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
{\em decryptor} & Decryption key slot\\
\hline
{\em key\-Blob} & Key blob address\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_afdddf2b7c66040b9f1cd5583c25d3c88}{\index{shack.\-h@{shack.\-h}!Shack\-Save\-Key@{Shack\-Save\-Key}}
\index{Shack\-Save\-Key@{Shack\-Save\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Save\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Save\-Key (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{source, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{encryptor, }
\item[{Ptr\-\_\-\-Msg384\-\_\-t}]{key\-Blob}
\end{DoxyParamCaption}
)}}\label{shack_8h_afdddf2b7c66040b9f1cd5583c25d3c88}


Saves a key into a key blob. 

{\bfseries Description\-:} Takes a key slot to save and uses the key value in the encryption key slot to encrypt and integrity tag the saved key value and attributes into a key blob that can be used by Load\-Key in the future. The future Load\-Key will only succeed if the key in the source key slot is the same as the value in the source key at Save\-Key time. Note that this Save\-Key operation will only be performed if the encryption key slot has the Is\-Device\-Secret attribute set.


\begin{DoxyParams}{Parameters}
{\em source} & Source key slot\\
\hline
{\em encryptor} & Encryption key slot\\
\hline
{\em key\-Blob} & Output key blob address\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a1f4f36e7dd353e4d9b4a59edc8531df0}{\index{shack.\-h@{shack.\-h}!Shack\-Send\-Key@{Shack\-Send\-Key}}
\index{Shack\-Send\-Key@{Shack\-Send\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Send\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Send\-Key (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{target, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{source}
\end{DoxyParamCaption}
)}}\label{shack_8h_a1f4f36e7dd353e4d9b4a59edc8531df0}


Send a key through a private hardware channel to another silicon based crypto accelerator on the same die. 

{\bfseries Description\-:} Sends a key through a private hardware channel to another silicon based crypto accelerator on the same die (e.\-g. S\-C\-P). Both the 256-\/bit key, and the 24 bits of attribute are sent over the private key interface.


\begin{DoxyParams}{Parameters}
{\em target} & Destination key address\\
\hline
{\em source} & Source key slot\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_aef9f4b026f0d0193bccf8833576c3980}{\index{shack.\-h@{shack.\-h}!Shack\-Set\-Key@{Shack\-Set\-Key}}
\index{Shack\-Set\-Key@{Shack\-Set\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Set\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Set\-Key (
\begin{DoxyParamCaption}
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{target, }
\item[{Const\-Ptr\-\_\-\-Msg256\-\_\-t}]{key\-Data, }
\item[{uint32\-\_\-t}]{attributes}
\end{DoxyParamCaption}
)}}\label{shack_8h_aef9f4b026f0d0193bccf8833576c3980}


Set a key value into a key slot along with supplied attributes. 

{\bfseries Description\-:} Set a key value into a key slot along with supplied attributes. The C\-C\-S expects Is\-Device\-Secret to be zero on input attributes, if it is not, it will silently clear it to zero before attributes are written to the K\-S\-U. (Note that a nonzero input value for the Is\-Device\-Secret attribute is not an error.)


\begin{DoxyParams}{Parameters}
{\em target} & Destination key slot\\
\hline
{\em key\-Data} & Address of 256-\/bit key\\
\hline
{\em attributes} & Attributes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{shack_8h_a4ef864a8f5992d8626df2b5f6ac03fe7}{\index{shack.\-h@{shack.\-h}!Shack\-Store\-Key@{Shack\-Store\-Key}}
\index{Shack\-Store\-Key@{Shack\-Store\-Key}!shack.h@{shack.\-h}}
\subsubsection[{Shack\-Store\-Key}]{\setlength{\rightskip}{0pt plus 5cm}void Shack\-Store\-Key (
\begin{DoxyParamCaption}
\item[{Const\-Ptr\-\_\-\-Msg256\-\_\-t}]{key\-Data, }
\item[{uint32\-\_\-t}]{attributes, }
\item[{{\bf Ksu\-\_\-\-Key\-\_\-\-Slot\-\_\-t}}]{encryptor, }
\item[{Ptr\-\_\-\-Msg384\-\_\-t}]{key\-Blob}
\end{DoxyParamCaption}
)}}\label{shack_8h_a4ef864a8f5992d8626df2b5f6ac03fe7}


Stores a key into a key blob. 

{\bfseries Description\-:} Takes a 256-\/bit key value, and associated 24-\/bit attribute as input, and uses the specified encryption key slot to encrypt and add an integrity tag value to a key blob that can be used by Load\-Key in the future. The future Load\-Key will only succeed if the key in the decryption register is the same as the value in the encryption key register at Store\-Key time.


\begin{DoxyParams}{Parameters}
{\em key\-Data} & Address of 256-\/bit key\\
\hline
{\em attributes} & Attributes\\
\hline
{\em encryptor} & Encryption key slot\\
\hline
{\em key\-Blob} & Output key blob address\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
